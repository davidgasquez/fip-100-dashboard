---
import LineChart from "../components/LineChart.astro";
import powerAdded from "../../public/power_added.json";
import participatingMiners from "../../public/participating_miner_count.json";
import precommitSectorBatchSize from "../../public/precommit_sector_batch_size.json";
---

<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link
			rel="icon"
			type="image/svg+xml"
			href="/fip-100-dashboard/favicon.svg"
		/>
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&display=swap"
			rel="stylesheet"
		/>
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>FIP-100 Dashboard</title>
		<style>
			:root {
				color-scheme: light;
				--ink: #0f172a;
				--muted: #475569;
				--surface: #ffffff;
				--border: rgba(15, 23, 42, 0.15);
			}

			*,
			*::before,
			*::after {
				box-sizing: border-box;
			}

			body {
				margin: 0;
				background: var(--surface);
				color: var(--ink);
				font-family: "JetBrains Mono", monospace;
				line-height: 1.7;
				min-height: 100vh;
				min-height: 100svh;
				display: flex;
				flex-direction: column;
			}

			main {
				width: 100%;
				max-inline-size: 60rem;
				margin-inline: auto;
				padding-inline: 1.5rem;
				flex: 1;
				padding-block: 1.5rem 2.5rem;
				display: flex;
				flex-direction: column;
				gap: 2.5rem;
			}

			.page-header {
				display: grid;
				gap: 0.25rem 1rem;
				grid-template-columns: minmax(0, 1fr) auto;
				grid-template-areas:
					". link"
					"title title"
					"subtitle subtitle";
				align-items: start;
			}

			h1 {
				margin: 0;
				font-size: clamp(2.2rem, 6vw, 3.4rem);
				text-transform: uppercase;
				letter-spacing: 0.08em;
				line-height: 1.1;
				text-wrap: balance;
			}

			.page-header h1 {
				grid-area: title;
			}

			.subtitle {
				margin: 0;
				font-size: clamp(1rem, 3vw, 1.2rem);
				color: var(--muted);
				max-inline-size: 46rem;
				text-wrap: pretty;
				grid-area: subtitle;
			}

			.charts {
				display: flex;
				flex-direction: column;
				gap: 2.25rem;
			}

			.header-links {
				grid-area: link;
				justify-self: end;
				align-self: start;
				display: flex;
				flex-wrap: nowrap;
				align-items: center;
				gap: 0.4rem 1.25rem;
				white-space: nowrap;
				font-size: 0.8rem;
				letter-spacing: 0.04em;
				text-transform: lowercase;
				margin-bottom: 0.6rem;
			}

			.header-links a {
				color: var(--muted);
				text-decoration: none;
			}

			.header-links a:visited {
				color: var(--muted);
			}

			.header-links a:hover,
			.header-links a:focus-visible {
				color: var(--ink);
			}
		</style>
	</head>
	<body>
		<main>
			<header class="page-header">
				<h1>FIP-100 Dashboard</h1>
				<nav class="header-links" aria-label="Resources">
					<a href="https://github.com/davidgasquez/fip-100-dashboard"
						>[source]</a
					>
					<a
						href="https://github.com/filecoin-project/FIPs/blob/master/FIPS/fip-0100.md"
						>[fip-100]</a
					>
					<a
						href="https://github.com/filecoin-project/FIPs/discussions/1105"
						>[discussion]</a
					>
					<a
						href="https://github.com/filecoin-project/community/discussions/74"
						>[timelines]</a
					>
				</nav>
				<p class="subtitle">
					Metrics to track FIP 100 real-world network behavior
				</p>
			</header>

			<section class="charts" aria-label="Charts">
				<LineChart
					data={powerAdded}
					x="date"
					y="raw_power_added"
					label="Raw Power Added"
					yLabel="PiB"
				/>
				<LineChart
					data={powerAdded}
					x="date"
					y="quality_adjusted_power_added"
					label="Quality Adjusted Power Added"
					yLabel="PiB (QAP)"
				/>
				<LineChart
					data={participatingMiners}
					x="date"
					y="participating_miner_count"
					label="Participating Miner Count"
					yLabel="Miners"
				/>
				<LineChart
					data={precommitSectorBatchSize}
					x="date"
					y="avg_sectors_per_message"
					label="PreCommitSectorBatch2 mean batch size"
					subtitle="Source: PreCommitSectorBatch2 messages"
					yLabel="Sectors"
				/>
				<LineChart
					data={precommitSectorBatchSize}
					x="date"
					y="messages"
					label="PreCommitSectorBatch2 proof aggregation messages"
					subtitle="Source: PreCommitSectorBatch2 messages"
					yLabel="Messages"
				/>
			</section>
		</main>
	</body>
</html>
